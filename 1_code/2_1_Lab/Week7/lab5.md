# OOP Lab 5

## 新特性

1. `Gomoku`模式  
    五子棋模式  
2. 支持打印当前轮数
3. 添加步骤记录（以供后续可能的悔棋功能）  

## 开发记录

1. [ ] `Gomoku`模式  
    1. [x] 初始化  
    2. [x] 下棋  
    3. [x] 轮替  
    4. [ ] 信息打印  
    5. [x] 规则判断  
    6. [x] 胜负判断  
2. [ ] 支持打印当前轮数  
3. [ ] 添加步骤记录  
4. [ ] 优化`CommandResult`接口  
    1. [ ] 更合理地返回信息
    2. [ ] 更合理的错误信息提示
5. [ ] 优化部分
    1. [ ] 多余接口优化
    2. [ ] 封装有待优化  
    3. [ ] 或许可以将`GameMode`中的部分状态检察逻辑放入`Command`包中（同时可以获得更详细的错误信息）  
    4. [ ] 或许可以稍微改一下`Reversi`返回胜者逻辑  
        增加胜者保存，结束并且胜者存在就返回胜者  
        否则就是平局  

### 构思

1. `Gomoku`模式  
    1. 继承自抽象类`GameMode`  
    2. 修改`ChessBoard`，将初始化棋盘行为进行调整  
    3. 基本逻辑模式依然保持不变  
    4. 胜负判断构思
        1. 可以沿用`MoveFocus`  
        2. 现在总体分为4个方向
            1. 横向
            2. 纵向
            3. 左斜
            4. 右斜
        3. 沿某个方向达到5个棋子连成一线即判胜利  
        4. 棋盘下满，未有人胜利，判平局  
        5. 游戏结束后不能悔棋  
2. `Command`包进行调整  
    1. `Command`包借用`instanceof`进行类型检验  
    2. `CommandResult`接口调整  
3. 步骤记录  
    1. 在`GameMode`中添加两个栈结构  
        1. `stepStack`：存储每一步的棋子位置以及棋子颜色  
        2. `undoStack`：存储悔棋的棋子位置以及棋子颜色  
            这个暂时不会用，先留着  
    2. 在`GameMode`中添加抽象方法  
        前两个现在加入，后面两个后续再加入  
        1. `addStep`：添加步骤  
        2. `countStep`：计算步骤  
        3. `undoStep`：悔棋步骤  
        4. `redoStep`：重做步骤  
4. 部分多余接口优化
    1. 尝试消灭掉`GameMode`初始化中的`gameMode`参数  

## bug修复

**Severe Bugs**

- [x] PeaceMode下棋更新有误(player1为白棋时会下黑棋)  
- [ ] 