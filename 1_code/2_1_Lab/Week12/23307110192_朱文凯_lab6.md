# Reversi Game Ver5.0 : 翻转棋游戏v5.0

## 1. Manual : 游戏说明

### 1.1. Start : 开始游戏

```bash
java -jar ./target/lab6-5.0.jar
```

### 1.2. Play and Rule : 游戏流程与规则

1. 进入游戏
2. 输入玩家1与玩家2名称，并选择棋子颜色
3. 游戏开始，黑棋先行
4. 游戏模式：  
    1. `peace` ：和平模式  
        无规则，不可重复，下满结束
    2. `reversi` : 翻转棋模式  
        标准翻转棋规则  
    3. `gomoku` : 五子棋模式  
        带炸弹和阻碍物的五子棋模式  
5. 规则说明：  
    1. `reversi`规则说明：  
        1. 棋子放置在空格上
        2. 棋子放置后，对方棋子被夹在两个己方棋子之间
        3. 对方被夹住的棋子全部翻转为己方棋子
        4. 轮替：如有合法棋步，必须执行；无合法棋步，输入`pass`跳过
        5. 当前棋盘棋局结束：两方都无合法棋步
        6. 游戏结束：当所有棋盘游戏结束后，可以选择退出
    2. `gomoku`规则说明：  
        1. 棋子放置在空格上
        2. 当某一方的棋子在横向、纵向、左斜、右斜方向上有5个棋子连成一线时，判定为胜利  
        3. 棋盘下满，未有人胜利，判平局  
        4. 障碍物`#`上不可以下棋  
        5. 炸弹只能用来炸对方棋子，炸完后会留下弹坑`@`，其上不能下棋  
            初始白方有3个炸弹，黑方有2个炸弹  
6. 输入说明：  
    1. 棋子位置：`1A`表示第一行第一列
    2. 输入格式：`{行序号}{列序号}`，如`1A`
        *注：现在支持大小写兼容*  
    3. 新建棋盘: `peace`/`reversi`/`gomoku`创建对应模式的新棋盘  
        目前限制最大同时与运行棋盘数为8  
    4. 切换棋盘: 输入对应棋盘序号，切换到对应棋盘
    5. 退出游戏: 可以选择输入`quit`退出游戏  
    6. 专属输入：  
        1. `pass`：跳过操作，`reversi`模式专属  
        2. `@{行序号}{列序号}`：炸弹操作，`gomoku`模式专属  
    7. 演示Demo：`playback {GameMode}.cmd`  
        输入对应的游戏的名称可以进行演示  

## 2. Changelog of Ver5.0 : v5.0更新内容

### 2.1. New Features : 新增特性

1. `gomoku`模式新特性  
    1. 炸弹操作
    2. 初始障碍物  
2. `playback`演示Demo功能  

### 2.2. Optimization : 优化

1. 调整了CLI模式下输入panel的布局  
2. 进一步优化了任务回显的区分度  

## 3. Project Structure : 项目结构

lab6的项目架构经过了新的一轮的大型重构  

总结：  

1. 进一步采用MVC架构  
2. 引入了Observer Pattern模式  

在为GUI模式的设计做准备的同时  
向后兼容了CLI模式的设计  

### 3.1. Specific Structure : 具体结构

```txt
main
├── java
│   └── top
│       └── thesumst
│           ├── Main.java
│           ├── core
│           │   ├── command
│           │   │   ├── BombCommand.java
│           │   │   ├── CommandFactory.java
│           │   │   ├── CommandResult.java
│           │   │   ├── GameCommand.java
│           │   │   ├── GoCommand.java
│           │   │   ├── NewGameCommand.java
│           │   │   ├── PassCommand.java
│           │   │   ├── PlaybackCommand.java
│           │   │   ├── QuitCommand.java
│           │   │   └── SwitchBoardCommand.java
│           │   ├── container
│           │   │   ├── GameContainer.java
│           │   │   └── GameList.java
│           │   ├── loop
│           │   │   ├── CLIGameLoop.java
│           │   │   ├── GUIGameLoop.java
│           │   │   ├── GameLoop.java
│           │   │   └── GameLoopFactory.java
│           │   └── mode
│           │       ├── GameMode.java
│           │       ├── GomokuMode.java
│           │       ├── PeaceMode.java
│           │       └── ReversiMode.java
│           ├── io
│           │   ├── input
│           │   │   ├── InputParser.java
│           │   │   ├── InputResult.java
│           │   │   └── InputType.java
│           │   └── provider
│           │       ├── BaseCommandProvider.java
│           │       ├── CLICommandProvider.java
│           │       ├── CommandProviderFactory.java
│           │       ├── GUICommandProvider.java
│           │       └── PlaybackCommandProvider.java
│           ├── observer
│           │   ├── BaseSubject.java
│           │   ├── Observer.java
│           │   └── Subject.java
│           ├── tools
│           │   ├── PauseTools.java
│           │   └── ScannerTools.java
│           ├── type
│           │   ├── ChessStatement.java
│           │   ├── Direction.java
│           │   ├── Event.java
│           │   ├── EventState.java
│           │   ├── EventType.java
│           │   ├── Operation.java
│           │   ├── OperationType.java
│           │   ├── component
│           │   │   ├── ChessBoard.java
│           │   │   ├── Player.java
│           │   │   └── Step.java
│           │   └── exception
│           │       ├── IllegalCommandException.java
│           │       └── IllegalMoveException.java
│           └── view
│               ├── ViewFactory.java
│               ├── console
│               │   ├── CLIPrintTools.java
│               │   └── CLIView.java
│               └── gui
│                   └── GUIView.java
└── resources
    └── top
        └── thesumst
            └── scripts
                ├── gomoku.cmd
                ├── peace.cmd
                └── reversi.cmd
```

总的来说分为几个具体模块：  

1. model  
    type包中主要是数据模型，包含了棋盘、玩家、步数等基本数据模型  
    core包中是主要游戏逻辑的实现，包含了游戏模式、游戏循环等  
    最直接的与数据模型交互的部分为mode包中的游戏模式  
    container中是游戏运行的容器，游戏模式实例被装在GameList之中，通过GameContainer进行管理  
    container借助loop包中工具进行更具体的游戏循环管理  
2. controller  
    provider包获取来自用户的命令  
    type中的Event作为游戏中主要的信息传递载体  
    command作为重要的控制器，将命令具体化分为一个一个类  
    io负责获取玩家操作并进行解析和处理  
3. view  
    源于observer包中的Observer接口  
    显示的通知来自于Subject的通知  

## 4. Ver4.0 Detail Design : V5.0细节设计

## 5. Presentation of Test Running : 运行测试
